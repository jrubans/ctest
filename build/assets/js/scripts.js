var flatpickr;flatpickr.l10ns.default.firstDayOfWeek=1;var currentPage=1,url=new URL(window.location.href);url.searchParams.get("page")&&(currentPage=parseInt(url.searchParams.get("page")));var data=[],currentData=[],allEventDates=[];fetch("assets/data/mock_data2019.json").then((function(e){return e.json()})).then((function(e){var t,a;for(a=0;a<e.length;a++)t=new Date(e[a].date+" "+e[a].time),e[a].dateTime=t;e.sort((function(e,t){return e.dateTime-t.dateTime})),data=e;var n=(currentData=e)[0].dateTime,r=currentData[currentData.length-1].dateTime,c=n,i=r,l=Math.ceil(currentData.length/6),u=[];window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage);var o,d=document.querySelector(".pager.prev"),s=document.querySelector(".pager.next"),g=function(e,t){t.length<=0?document.getElementById("not_found").classList.add("show"):document.getElementById("not_found").classList.remove("show"),window.scrollTo(0,0),l=Math.ceil(t.length/6),document.querySelector("#total_pages").innerHTML=l.toString(),e<=1?(e=1,d.classList.add("disabled")):d.classList.remove("disabled"),e>=l?(e=l,s.classList.add("disabled")):s.classList.remove("disabled"),document.querySelector("#current_page").innerHTML=e.toString(),function(e,t,a){u=e.slice((a-1)*t,a*t);var n,r="";for(n=0;n<u.length;n++){var c=null==u[n].lead_image?"assets/img/placeholder.svg":u[n].lead_image;r+='<div class="col-6 col-sm-6 col-md-4 item"><a href="#"><div class="date">'+new Date(u[n].dateTime).toLocaleDateString("lv-LV",{year:"numeric",month:"long",day:"numeric",timeZone:"utc"})+'</div><div class="img-ct"><img loading="lazy" src="'+c+'" alt="'+u[n].title+'"></div><div class="category"><span>'+u[n].type+"</span></div><h3>"+u[n].title+"</h3></a></div>"}document.getElementById("item_list").innerHTML=r,document.querySelectorAll(".item > a").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault()}))}))}(t,6,e)};for(d.addEventListener("click",(function(e){currentPage-=1,window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage),g(currentPage,currentData)})),s.addEventListener("click",(function(e){currentPage+=1,window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage),g(currentPage,currentData)})),g(currentPage,currentData),window.addEventListener("popstate",(function(e){currentPage=e.state.page,g(currentPage,currentData)})),o=0;o<currentData.length;o++)allEventDates.push(Date.parse(currentData[o].date));flatpickr("#datepicker",{mode:"range",locale:"lv",minDate:n,maxDate:r,disableMobile:"true",onDayCreate:function(e,t,a,n){-1!==allEventDates.indexOf(+n.dateObj)&&(n.className+=" has-event")},onClose:function(e,t,a){var n,r;e.length>=2&&(c=new Date(e[0]),i=new Date(e[1]),n=i,r=24,i=new Date(new Date(n).setHours(n.getHours()+r)),document.querySelectorAll('#type_filters input[type="checkbox"]').forEach((function(e){var t=document.getElementById(e.id);m(event,t)})))}});function m(e,t){var a,n,r=[],l=[];if(currentPage=1,"Visas tēmas"==t.value){if(t.checked)for(currentData=(currentData=data).filter((function(e){var t=e.dateTime;return t>=c&&t<=i})),g(currentPage,currentData),window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage),r=[],n=1;n<f.length;n++)f[n].checked=!1}else if(document.querySelectorAll('#type_filters input[type="checkbox"]:checked').length<=0)f[0].checked=!0,currentData=(currentData=data).filter((function(e){var t=e.dateTime;return t>=c&&t<=i})),g(currentPage,currentData),window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage);else{f[0].checked=!1,a=document.querySelectorAll('#type_filters input[type="checkbox"]:checked');var u=0;a.forEach((function(e){if(u<a.length){var t=document.getElementById(e.id);l.push(t.value),r=r.concat(data.filter((function(e){return e.type.indexOf(t.value)>-1})))}u+1==a.length&&(r.sort((function(e,t){return e.dateTime-t.dateTime})),currentData=r.filter((function(e){var t=e.dateTime;return t>=c&&t<=i})),g(currentPage,currentData),window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage)),u++}))}}!function(e){var t=[];(t=e.map((function(e){return e.type})).filter((function(e,t,a){return a.indexOf(e)==t}))).unshift("Visas tēmas");var a,n="";for(a=0;a<t.length;a++)n+='<div class="form-check py-1"><input class="form-check-input" type="checkbox" value="'+t[a]+'" id="'+t[a]+'"><label class="form-check-label" for="'+t[a]+'">'+t[a]+"</label></div>";document.getElementById("type_filters").innerHTML=n}(data);var f=document.querySelectorAll('#type_filters input[type="checkbox"]');f[0].checked=!0,document.querySelectorAll('#type_filters input[type="checkbox"]').forEach((function(e){var t=document.getElementById(e.id);t.addEventListener("change",(function(e){m(0,t)}))})),document.getElementById("loading").classList.add("loaded"),setTimeout((function(){document.getElementById("loading").remove()}),1e3);var p=document.getElementById("menu-button");p.addEventListener("click",(function(e){p.classList.toggle("opened"),document.getElementById("sidebar_filter").classList.toggle("opened"),document.getElementsByTagName("HTML")[0].classList.toggle("noscroll")}))}));