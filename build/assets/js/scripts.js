var flatpickr;flatpickr.l10ns.default.firstDayOfWeek=1;var currentPage=1,url=new URL(window.location.href);url.searchParams.get("page")&&(currentPage=parseInt(url.searchParams.get("page")));var data=[],currentData=[],allEventDates=[];fetch("assets/data/mock_data2019.json").then((function(e){return e.json()})).then((function(e){var t,a;for(a=0;a<e.length;a++)t=new Date(e[a].date+" "+e[a].time),e[a].dateTime=t;e.sort((function(e,t){return e.dateTime-t.dateTime})),data=e;var n=(currentData=e)[0].dateTime,r=currentData[currentData.length-1].dateTime,c=n,i=r,l=Math.ceil(currentData.length/6),o=[];window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage);var d,u=document.querySelector(".pager.prev"),s=document.querySelector(".pager.next"),g=function(e,t){t.length<=0?document.getElementById("not_found").classList.add("show"):document.getElementById("not_found").classList.remove("show"),window.scroll({top:0,left:0,behavior:"smooth"}),l=Math.ceil(t.length/6),document.querySelector("#total_pages").innerHTML=l.toString(),e<=1?(e=1,u.classList.add("disabled")):u.classList.remove("disabled"),e>=l?(e=l,s.classList.add("disabled")):s.classList.remove("disabled"),document.querySelector("#current_page").innerHTML=e.toString(),function(e,t,a){o=e.slice((a-1)*t,a*t);var n,r="";for(n=0;n<o.length;n++){var c=null==o[n].lead_image?"assets/img/placeholder.svg":o[n].lead_image;r+='<div class="col-12 col-sm-6 col-md-4 item"><a href="#"><div class="date">'+new Date(o[n].dateTime).toLocaleDateString("lv-LV",{year:"numeric",month:"long",day:"numeric",timeZone:"utc"})+'</div><div class="img-ct"><img loading="lazy" src="'+c+'" alt="'+o[n].title+'"></div><div class="category"><span>'+o[n].type+"</span></div><h3>"+o[n].title+"</h3></a></div>"}document.getElementById("item_list").innerHTML=r,document.querySelectorAll(".item > a").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault()}))}))}(t,6,e)};for(u.addEventListener("click",(function(e){currentPage-=1,window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage),g(currentPage,currentData)})),s.addEventListener("click",(function(e){currentPage+=1,window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage),g(currentPage,currentData)})),g(currentPage,currentData),window.addEventListener("popstate",(function(e){currentPage=e.state.page,g(currentPage,currentData)})),d=0;d<currentData.length;d++)allEventDates.push(Date.parse(currentData[d].date));var m=flatpickr("#datepicker",{mode:"range",locale:"lv",minDate:n,maxDate:r,animate:!1,disableMobile:!0,onDayCreate:function(e,t,a,n){-1!==allEventDates.indexOf(+n.dateObj)&&(n.className+=" has-event")},onClose:function(e,t,a){var n,r;e.length>=2&&(c=new Date(e[0]),i=new Date(e[1]),n=i,r=24,i=new Date(new Date(n).setHours(n.getHours()+r)),document.querySelectorAll('#type_filters input[type="checkbox"]').forEach((function(e){f(document.getElementById(e.id))})))}});function f(e){var t,a=[],n=[];function r(e){var t;for(currentData=(currentData=data).filter((function(e){var t=e.dateTime;return t>=c&&t<=i})),g(currentPage,currentData),window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage),a=[],t=1;t<p.length;t++)p[t].checked=!1}if(currentPage=1,"Visas tēmas"==e.value&&e.checked)r();else if(document.querySelectorAll('#type_filters input[type="checkbox"]:checked').length<=0)p[0].checked=!0,r();else{p[0].checked=!1,t=document.querySelectorAll('#type_filters input[type="checkbox"]:checked');var l=0;t.forEach((function(e){if(l<t.length){var r=document.getElementById(e.id);n.push(r.value),a=a.concat(data.filter((function(e){return e.type.indexOf(r.value)>-1})))}l+1==t.length&&(a.sort((function(e,t){return e.dateTime-t.dateTime})),currentData=a.filter((function(e){var t=e.dateTime;return t>=c&&t<=i})),g(currentPage,currentData),window.history.pushState({page:currentPage},"title "+currentPage,"?page="+currentPage)),l++}))}}window.addEventListener("scroll",(function(){m._positionCalendar()})),function(e){var t=[];(t=e.map((function(e){return e.type})).filter((function(e,t,a){return a.indexOf(e)==t}))).unshift("Visas tēmas");var a,n="";for(a=0;a<t.length;a++)n+='<div class="form-check py-1"><input class="form-check-input" type="checkbox" value="'+t[a]+'" id="'+t[a]+'"><label class="form-check-label" for="'+t[a]+'">'+t[a]+"</label></div>";document.getElementById("type_filters").innerHTML=n}(data);var p=document.querySelectorAll('#type_filters input[type="checkbox"]');p[0].checked=!0,document.querySelectorAll('#type_filters input[type="checkbox"]').forEach((function(e){var t=document.getElementById(e.id);t.addEventListener("change",(function(e){f(t)}))})),document.getElementById("loading").classList.add("loaded"),setTimeout((function(){document.getElementById("loading").remove()}),1e3);var h=document.getElementById("menu-button");h.addEventListener("click",(function(e){h.classList.toggle("opened"),document.getElementById("sidebar_filter").classList.toggle("opened"),document.getElementsByTagName("HTML")[0].classList.toggle("noscroll"),document.getElementById("backdrop_mask").classList.toggle("opened")})),document.getElementById("backdrop_mask").addEventListener("click",(function(e){document.getElementById("sidebar_filter").classList.remove("opened"),document.getElementsByTagName("HTML")[0].classList.remove("noscroll"),document.getElementById("backdrop_mask").classList.remove("opened")}))}));